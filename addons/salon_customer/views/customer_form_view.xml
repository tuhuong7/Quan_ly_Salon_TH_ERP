<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <record id="view_customer_form" model="ir.ui.view">
    <field name="name">salon.customer.form</field>
    <field name="model">salon.customer</field>
    <field name="arch" type="xml">
      <form string="Khách hàng" class="o_salon_customer_form">
        <sheet>
          <div class="oe_button_box" name="button_box">
            <button name="action_open_service_history" 
                    type="object" 
                    class="oe_stat_button" 
                    icon="fa-history"
                    context="{'default_customer_id': id}">
              <field name="service_history_count" widget="statinfo" string="Lịch sử dịch vụ"/>
            </button>
          </div>
          
          <div class="oe_title">
            <label for="name" class="oe_edit_only"/>
            <h1>
              <field name="name" placeholder="Họ và tên khách hàng..." class="o_salon_customer_name"/>
            </h1>
            <div class="o_row">
              <field name="code" readonly="1" class="text-muted"/>
              <field name="membership_rank_id" 
                     widget="badge" 
                     decoration-success="membership_rank_id.name == 'VIP'"
                     decoration-info="membership_rank_id.name in ['Vàng', 'Bạch Kim']"
                     decoration-warning="membership_rank_id.name == 'Bạc'"
                     decoration-muted="membership_rank_id.name == 'Đồng'"
                     options="{'no_create': True, 'no_create_edit': True}"/>
            </div>
          </div>

            <group>
            <group string="Thông tin liên hệ" col="2">
              <field name="phone" widget="phone" required="1" 
                     options="{'always_render': True}"/>
              <field name="email" widget="email"/>
              <field name="address" placeholder="Địa chỉ..."/>
              <field name="birthday" widget="date"/>
            </group>
            <group string="Thông tin cá nhân" col="2">
              <field name="gender" widget="radio" 
                    options="{'horizontal': true}"/>
            </group>
          </group>

          <notebook>
            <page string="Thống kê" name="statistics">
              <group>
                <group string="Tổng quan">
                  <field name="total_spent" widget="monetary" readonly="1"
                        class="o_salon_stat_field"
                        options="{'decimal_places': 0}"/>
                  <field name="visit_count" readonly="1" 
                        class="o_salon_stat_field"/>
                  <field name="currency_id" invisible="1"/>
                </group>
                <group string="Hạng thành viên">
                  <field name="membership_rank_id" 
                        widget="badge"
                        decoration-success="membership_rank_id.name == 'VIP'"
                        decoration-info="membership_rank_id.name in ['Vàng', 'Bạch Kim']"
                        decoration-warning="membership_rank_id.name == 'Bạc'"
                        decoration-muted="membership_rank_id.name == 'Đồng'"
                        options="{'no_create': True, 'no_create_edit': True}"
                        readonly="1"/>
                </group>
              </group>
            </page>
            <page string="Lịch sử dịch vụ" name="service_history" invisible="service_history_count == 0">
              <group>
                <div class="alert alert-info" role="alert">
                  <p>Để xem chi tiết lịch sử dịch vụ, vui lòng click vào nút "Lịch sử dịch vụ" ở trên.</p>
                </div>
              </group>
            </page>
          </notebook>
        </sheet>
        <chatter/>
      </form>
    </field>
  </record>
</odoo>

